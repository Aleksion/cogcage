import { e as createComponent, g as addAttribute, l as renderHead, n as renderSlot, r as renderTemplate, h as createAstro, k as renderComponent, m as maybeRenderHead } from '../chunks/astro/server_Bw4UisD-.mjs';
import 'piccolore';
import 'clsx';
/* empty css                                   */
export { renderers } from '../renderers.mjs';

const $$Astro = createAstro();
const $$Layout = createComponent(($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Layout;
  const {
    title = "CogCage \u2014 AI Skill Arena",
    description = "Compete in AI-powered skill ladders. Climb ranks, unlock rewards, and join the alpha waitlist."
  } = Astro2.props;
  return renderTemplate`<html lang="en" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" href="/favicon.ico"><meta name="generator"${addAttribute(Astro2.generator, "content")}><title>${title}</title><meta name="description"${addAttribute(description, "content")}>${renderHead()}</head> <body data-astro-cid-sckkx6r4> ${renderSlot($$result, $$slots["default"])} </body></html>`;
}, "/Users/thealeks/clawd-engineer/projects/cogcage/repo/web/src/layouts/Layout.astro", void 0);

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Success = createComponent(async ($$result, $$props, $$slots) => {
  return renderTemplate(_a || (_a = __template(["", " <script>\n  const key = 'cogcage_paid_conversions';\n  const pendingKey = 'cogcage_pending_paid_conversions';\n\n  function rememberPaidConversion(id) {\n    const known = JSON.parse(localStorage.getItem(key) || '[]');\n    if (!known.includes(id)) {\n      known.push(id);\n      localStorage.setItem(key, JSON.stringify(known.slice(-200)));\n    }\n  }\n\n  function hasPaidConversion(id) {\n    const known = JSON.parse(localStorage.getItem(key) || '[]');\n    return known.includes(id);\n  }\n\n  function rememberPending(payload) {\n    if (!payload?.eventId) return;\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    const deduped = queue.filter((entry) => entry?.eventId !== payload.eventId);\n    deduped.push(payload);\n    localStorage.setItem(pendingKey, JSON.stringify(deduped.slice(-50)));\n  }\n\n  function clearPending(eventId) {\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    const next = queue.filter((entry) => entry?.eventId !== eventId);\n    localStorage.setItem(pendingKey, JSON.stringify(next));\n  }\n\n  async function postConversion(payload) {\n    const body = JSON.stringify(payload);\n\n    try {\n      const response = await fetch('/api/checkout-success', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          Accept: 'application/json',\n        },\n        body,\n        keepalive: true,\n      });\n      if (response.ok) return true;\n    } catch {\n      // Fall through to beacon.\n    }\n\n    try {\n      return navigator.sendBeacon('/api/checkout-success', new Blob([body], { type: 'application/json' }));\n    } catch {\n      return false;\n    }\n  }\n\n  async function flushPendingConversions() {\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    if (!Array.isArray(queue) || queue.length === 0) return;\n\n    for (const payload of queue) {\n      if (!payload?.eventId || hasPaidConversion(payload.eventId)) {\n        clearPending(payload?.eventId);\n        continue;\n      }\n      const ok = await postConversion(payload);\n      if (ok) {\n        rememberPaidConversion(payload.eventId);\n        clearPending(payload.eventId);\n      }\n    }\n  }\n\n  async function trackPaidConversion() {\n    const params = new URLSearchParams(window.location.search);\n    const sessionId = params.get('session_id') || params.get('checkout_session_id');\n    const email = params.get('prefilled_email') || localStorage.getItem('cogcage_email') || undefined;\n    const conversionId = sessionId || `success:${window.location.pathname}:${new Date().toISOString().slice(0, 10)}`;\n\n    if (hasPaidConversion(conversionId)) return;\n\n    const checkoutSource = localStorage.getItem('cogcage_last_founder_checkout_source') || 'stripe-success';\n    const checkoutIntentSource = localStorage.getItem('cogcage_last_founder_intent_source') || undefined;\n\n    const payload = {\n      eventId: conversionId,\n      page: window.location.pathname,\n      href: window.location.href,\n      source: checkoutSource,\n      tier: 'founder',\n      email,\n      meta: {\n        sessionId,\n        url: window.location.href,\n        checkoutSource,\n        checkoutIntentSource,\n      },\n    };\n\n    const ok = await postConversion(payload);\n    if (ok) {\n      rememberPaidConversion(conversionId);\n      clearPending(conversionId);\n      return;\n    }\n\n    rememberPending(payload);\n  }\n\n  flushPendingConversions().finally(() => {\n    trackPaidConversion();\n  });\n<\/script> "], ["", " <script>\n  const key = 'cogcage_paid_conversions';\n  const pendingKey = 'cogcage_pending_paid_conversions';\n\n  function rememberPaidConversion(id) {\n    const known = JSON.parse(localStorage.getItem(key) || '[]');\n    if (!known.includes(id)) {\n      known.push(id);\n      localStorage.setItem(key, JSON.stringify(known.slice(-200)));\n    }\n  }\n\n  function hasPaidConversion(id) {\n    const known = JSON.parse(localStorage.getItem(key) || '[]');\n    return known.includes(id);\n  }\n\n  function rememberPending(payload) {\n    if (!payload?.eventId) return;\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    const deduped = queue.filter((entry) => entry?.eventId !== payload.eventId);\n    deduped.push(payload);\n    localStorage.setItem(pendingKey, JSON.stringify(deduped.slice(-50)));\n  }\n\n  function clearPending(eventId) {\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    const next = queue.filter((entry) => entry?.eventId !== eventId);\n    localStorage.setItem(pendingKey, JSON.stringify(next));\n  }\n\n  async function postConversion(payload) {\n    const body = JSON.stringify(payload);\n\n    try {\n      const response = await fetch('/api/checkout-success', {\n        method: 'POST',\n        headers: {\n          'content-type': 'application/json',\n          Accept: 'application/json',\n        },\n        body,\n        keepalive: true,\n      });\n      if (response.ok) return true;\n    } catch {\n      // Fall through to beacon.\n    }\n\n    try {\n      return navigator.sendBeacon('/api/checkout-success', new Blob([body], { type: 'application/json' }));\n    } catch {\n      return false;\n    }\n  }\n\n  async function flushPendingConversions() {\n    const queue = JSON.parse(localStorage.getItem(pendingKey) || '[]');\n    if (!Array.isArray(queue) || queue.length === 0) return;\n\n    for (const payload of queue) {\n      if (!payload?.eventId || hasPaidConversion(payload.eventId)) {\n        clearPending(payload?.eventId);\n        continue;\n      }\n      const ok = await postConversion(payload);\n      if (ok) {\n        rememberPaidConversion(payload.eventId);\n        clearPending(payload.eventId);\n      }\n    }\n  }\n\n  async function trackPaidConversion() {\n    const params = new URLSearchParams(window.location.search);\n    const sessionId = params.get('session_id') || params.get('checkout_session_id');\n    const email = params.get('prefilled_email') || localStorage.getItem('cogcage_email') || undefined;\n    const conversionId = sessionId || \\`success:\\${window.location.pathname}:\\${new Date().toISOString().slice(0, 10)}\\`;\n\n    if (hasPaidConversion(conversionId)) return;\n\n    const checkoutSource = localStorage.getItem('cogcage_last_founder_checkout_source') || 'stripe-success';\n    const checkoutIntentSource = localStorage.getItem('cogcage_last_founder_intent_source') || undefined;\n\n    const payload = {\n      eventId: conversionId,\n      page: window.location.pathname,\n      href: window.location.href,\n      source: checkoutSource,\n      tier: 'founder',\n      email,\n      meta: {\n        sessionId,\n        url: window.location.href,\n        checkoutSource,\n        checkoutIntentSource,\n      },\n    };\n\n    const ok = await postConversion(payload);\n    if (ok) {\n      rememberPaidConversion(conversionId);\n      clearPending(conversionId);\n      return;\n    }\n\n    rememberPending(payload);\n  }\n\n  flushPendingConversions().finally(() => {\n    trackPaidConversion();\n  });\n<\/script> "])), renderComponent($$result, "Layout", $$Layout, { "title": "CogCage \u2014 Founder Spot Confirmed", "description": "Your CogCage Founder checkout is complete. Next steps for alpha access inside.", "data-astro-cid-5y44lzmc": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<main class="shell" data-astro-cid-5y44lzmc> <section class="panel success" data-astro-cid-5y44lzmc> <p class="eyebrow" data-astro-cid-5y44lzmc>PAYMENT CONFIRMED</p> <h1 data-astro-cid-5y44lzmc>You’re in — Founder spot reserved.</h1> <p data-astro-cid-5y44lzmc>
Thanks for backing CogCage early. We’re preparing your founder onboarding email with alpha queue details,
        rank-season kickoff timing, and tournament invite priority.
</p> <div class="next-steps" data-astro-cid-5y44lzmc> <article data-astro-cid-5y44lzmc> <strong data-astro-cid-5y44lzmc>1) Check your inbox</strong> <span data-astro-cid-5y44lzmc>Look for your Stripe receipt + CogCage onboarding within 24 hours.</span> </article> <article data-astro-cid-5y44lzmc> <strong data-astro-cid-5y44lzmc>2) Join waitlist backup</strong> <span data-astro-cid-5y44lzmc>If checkout used a different email, submit your preferred inbox on the homepage.</span> </article> </div> <div class="actions" data-astro-cid-5y44lzmc> <a class="button button-primary" href="/" data-astro-cid-5y44lzmc>Back to homepage</a> <a class="button button-secondary" href="/#join" data-astro-cid-5y44lzmc>Add backup email</a> </div> <p class="fine-print" data-astro-cid-5y44lzmc>Need help? Reply to your Stripe receipt and we’ll fix your founder access manually.</p> </section> </main> ` }));
}, "/Users/thealeks/clawd-engineer/projects/cogcage/repo/web/src/pages/success.astro", void 0);

const $$file = "/Users/thealeks/clawd-engineer/projects/cogcage/repo/web/src/pages/success.astro";
const $$url = "/success";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Success,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
